<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="fragments/fragments :: head"></head>
<!--<head>-->
<!--<meta charset="UTF-8" />-->

<!--<title>On the road again</title>-->
<!--</head>-->
<body class=" bg-light">
<nav th:replace="fragments/fragments :: navbar"></nav>

<header th:replace=" fragments/fragments :: header"></header>
<h1 class="container">Welcome back, <span th:text="${#authentication.principal.first}"/>! <hr class="hr-4"/></h1>

<main class="container row mx-auto">
    <!--progress bar test-->
    <!--<div id="myProgress">-->
        <!--<div id="myBar"></div>-->
    <!--</div>-->
    <!--<style>-->
        <!--#myProgress {-->
            <!--width: 100%;-->
            <!--background-color: grey;-->
        <!--}-->
        <!--#myBar {-->
            <!--width: 1%;-->
            <!--height: 30px;-->
            <!--background-color: green;-->
        <!--}-->
    <!--/*</style>*/-->

    <article class="col-6">
        <h2>Your Info</h2>
        <hr class="hr-4" />
        <h5><span th:text="${#authentication.principal.id}"/></h5>
        <h5>Username: <span th:text="${#authentication.principal.username}"/></h5>
        <h5>Email: <span th:text="${#authentication.principal.email}"/></h5>
        <hr class="hr-4" />
        <h2>Your Vehicles</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th scope="col">Year</th>
                <th scope="col">Vehicle</th>
                <th scope="col">Mileage</th>
                <th scope="col">License</th>
                <th scope="col">Remove</th>

            </tr>
            </thead>
            <tbody>
            <tr th:each="vehicle : ${#authentication.principal.vehicles}">
                <td th:text="${vehicle.year}" />
                <td th:text="${vehicle.make + ' ' + vehicle.model + ', ' + vehicle.color}" />
                <td th:text="${vehicle.mileage}" />
                <td th:text="${vehicle.license}" />
                <td><a href="/vehicles/delete" class="btn btn-danger">Remove</a></td>
            </tr>
            </tbody>
        </table>
        <a class="btn btn-warning btn-block" href="/vehicles/add">Add Vehicle</a>
    </article>

    <article class="col-6">
        <h2>Upcoming Appointments</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th scope="col">Date</th>
                <th scope="col">Vehicle</th>
                <th scope="col">Type</th>
                <th scope="col">Advisor</th>
                <th scope="col">Options</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="booking : ${bookings}">
                <td th:text="${booking.service_date}" />
                <td th:text="${booking.vehicle.make + ' ' + booking.vehicle.model}" />
                <!--uncomment when database is filled-->
                <!--<td th:text="${booking.service_type.description}" />-->
                <!--<td th:text="${booking.advisor.first}" />-->
                <td>
                    <a href="/booking/cancel" class="btn btn-danger">Cancel</a>
                    
                    <form th:action="@{/book/{id}(id=${booking.id})}" method="get" th:object="${booking.id}">
                        <button type="submit" class="btn btn-success">Details</button>
                    </form>


                </td>
            </tr>
            </tbody>
        </table>
        <a class="btn btn-warning btn-block" href="/booking/create">Book Service Appt</a>
        <hr class="hr-4" />
        <h2>Past Appointments</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th scope="col">Date</th>
                <th scope="col">Vehicle</th>
                <th scope="col">Type</th>
                <th scope="col">Advisor</th>
            </tr>
            </thead>
            <!--<tbody>-->
            <!--<tr th:each="vehicle : ${#authentication.principal.vehicles}">-->
                <!--<td th:text="${vehicle.year}" />-->
                <!--<td th:text="${vehicle.make + ' ' + vehicle.model + ', ' + vehicle.color}" />-->
                <!--<td th:text="${vehicle.mileage}" />-->
                <!--<td th:text="${vehicle.license}" />-->
            <!--</tr>-->
            <!--</tbody>-->
        </table>
    </article>

</main>

<footer th:replace="fragments/fragments :: footer"></footer>
<!--JS for progress bar this is just a test-->
<!--<script>-->
    <!--function move() {-->
        <!--var elem = document.getElementById("myBar");-->
        <!--var width = 1;-->
        <!--var id = setInterval(frame, 10);-->
        <!--function frame() {-->
            <!--if (width >= 100) {-->
                <!--clearInterval(id);-->
            <!--} else {-->
                <!--width++;-->
                <!--elem.style.width = width + '%';-->
            <!--}-->
        <!--}-->
    <!--}-->
<!--// </script>-->
</body>
</html>